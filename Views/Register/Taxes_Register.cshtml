@{
    Layout = null;
}

@model TaxesRegister

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>@ViewData["Title"] - Taxes_Register</title>
    <link rel="stylesheet" href="~/lib/bootstrap/dist/css/bootstrap.min.css" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.2/font/bootstrap-icons.css">
    <link rel="stylesheet" href="~/css/site.css" />

</head>
<body style="background-color: #0F3460;">
    <section class="container">
        <div class="container py-5 h-100">
            <div class="row d-flex justify-content-center align-content-between h-auto">
                <div class="col col-xl-10">
                    <div class="card" style="border-radius:1rem; border-color:white; height:100%;">
                        <div class="row flex-grow-1">
                            <div class="col-md-6 col-lg-5 d-md-block">
                                <img src="~/images/portada.jpg" class="img-fluid" style="border-radius:1rem 0 0 1rem; min-height:150px;" />
                            </div>

                            <!--Register Form-->
                            <form class="col-md-6 col-lg-5 row d-flex justify-content-center" method="post" href="@Url.Action("Taxes_Register","Register")">

                                <div class="form-inline mb-4">
                                    <h2 class="text-center">Ingrese su cita</h2>
                                </div>

                                <div class="form-inline mb-4">
                                    <input type="text" class="form-control form-control-lg" asp-for="Nombre" id="txt_name" placeholder="First Name" />
                                    <span asp-validation-for="Nombre" class="text-danger font-weight-bold"></span>
                                </div>

                                <div class="form-inline mb-4">
                                    <input type="text" class="form-control form-control-lg" asp-for="Apellidos" id="txt_lastname" placeholder="Last Name" />
                                    <span asp-validation-for="Apellidos" class="text-danger font-weight-bold"></span>

                                </div>

                                <div class="form-inline mb-4">
                                    <input type="number" class="form-control form-control-lg" asp-for="NoTelefono" id="txt_tel" placeholder="Phone" />
                                    <span asp-validation-for="NoTelefono" class="text-danger font-weight-bold"></span>

                                </div>

                                <div class="form-inline mb-4">
                                    <input type="email" class="form-control form-control-lg" asp-for="Correo" id="txt_email" placeholder="Email" />
                                    <span asp-validation-for="Correo" class="text-danger font-weight-bold"></span>

                                </div>

                                <div class="form-inline mb-4">
                                    <input type="datetime-local" class="form-control form-control-lg" asp-for="FechaRegistro" id="txtDate" onfocus="InitForm()" onchange="ValidateDate()" />
                                    <span asp-validation-for="FechaRegistro" class="text-danger  font-weight-bold"></span>

                                </div>

                                <div class="form-inline mb-4 ">
                                    <button class="btn btn-lg btn-outline-primary" id="btn_ingresar">Ingresar</button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
    @if (ViewBag.Message != null)
    {
        <script type="text/javascript">
                    window.onload = function () {
                        alert("@ViewBag.Message");
                        $('#txt_name').val('');
                        $('#txt_lastname').val('');
                        $('#txt_tel').val('');
                        $('#txt_email').val('');
                        $('#txtDate').val('');
                    }
        </script>
    }
    @if (ViewBag.Alert != null)
    {
        <script type="text/javascript">
                    window.onload = function () {
                        alert("@ViewBag.Alert");
                        $('#txt_name').val('');
                        $('#txt_lastname').val('');
                        $('#txt_tel').val('');
                        $('#txt_email').val('');
                        $('#txtDate').val('');
                    }
        </script>
    }
    @if (ViewBag.ErroDate != null)
    {
        <script type="text/javascript">
                    window.onload = function () {
                        alert("@ViewBag.ErroDate");

                        $('#txtDate').val('');
                    }
        </script>
    }


    <script type="text/javascript">
    function InitForm() {
        let year = @DateTime.Now.Year.ToString();
        let month = @DateTime.Now.Month>= 10 ? @DateTime.Now.Month.ToString(): '0' +@DateTime.Now.Month.ToString();
        let day = @DateTime.Now.Day>= 10 ? @DateTime.Now.Day.ToString(): '0' +@DateTime.Now.Day.ToString();

        $('#txtDate').attr({
            "min": year + '-' + month + '-' + day + 'T09:00',
            "max": '2023-06-30T18:00:00'
         })
    }

    function ValidateDate() {
        //let hour = $('#txtDate').val().substring(11)
        let getHours = new Date($('#txtDate').val()).getHours();
        let minute = new Date($('#txtDate').val()).getMinutes();
        //alert(getHours)

        if ((getHours === 13) || (getHours === 14 && minute === 0)) {
            alert('No hay citas disponibles de 1 a 2 pm')
            $('#txtDate').val('')
        } else if (getHours >= 1 && getHours <= 8) {
            alert('Las citas empiezan a partir de las 9 am')
            $('#txtDate').val('')
        }
        else if (getHours >= 18) {
            alert('Ya no se hacen citas de las 6 pm en adelante')
            $('#txtDate').val('')
        }

    }
    </script>

    <script src="~/lib/jquery/dist/jquery.min.js"></script>
    <script src="~/lib/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
    <script src="~/js/site.js" asp-append-version="true"></script>
</body>
</html>
